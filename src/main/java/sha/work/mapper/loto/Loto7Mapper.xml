<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="sha.work.mapper.loto.Loto7Mapper">
	<!-- RESULT MAP -->
	<resultMap id="NumberAndTurns" 
				type="sha.work.entity.loto.NumberAndTurns">
        
    </resultMap>
	
	<!-- SQL CHIP -->
	<sql id="selectNumber">
		SELECT 
			${prefix} AS numberName,
			COUNT(*) AS numberValue
		FROM 
			M_LOTO7
		WHERE (l1 = ${prefix} or l2 = ${prefix} or l3 = ${prefix} or l4 = ${prefix} or l5 = ${prefix} or l6 = ${prefix} or l7 = ${prefix})
	</sql>
	
	<sql id="selectBonusNumber1">
		SELECT 
			${prefix} AS numberName,
			COUNT(*) AS numberValue
		FROM 
			M_LOTO7
		WHERE (B1 = ${prefix})
	</sql>
	
	<sql id="selectBonusNumber2">
		SELECT 
			${prefix} AS numberName,
			COUNT(*) AS numberValue
		FROM 
			M_LOTO7
		WHERE (B2 = ${prefix})
	</sql>
	
	<select id="getNomalNumberSum" resultType="sha.work.entity.loto.NumberAndTurns">
		<foreach item="num" index="index" collection="loto7Hanyo">
			<if test="index > 0">UNION </if>
			<include refid="selectNumber"><property name="prefix" value="${num.value}"/></include>
		</foreach>
		ORDER BY numberName	
	</select>
	
	<select id="getBonusNumber1Sum" resultType="sha.work.entity.loto.NumberAndTurns">
		<foreach item="num" index="index" collection="loto7Hanyo">
			<if test="index > 0">UNION </if>
			<include refid="selectBonusNumber1"><property name="prefix" value="${index}"/></include>
		</foreach>
		ORDER BY numberName	
	</select>
	
	<select id="getBonusNumber2Sum" resultType="sha.work.entity.loto.NumberAndTurns">
		<foreach item="num" index="index" collection="loto7Hanyo">
			<if test="index > 0">UNION </if>
			<include refid="selectBonusNumber2"><property name="prefix" value="${index}"/></include>
		</foreach>
		ORDER BY numberName	
	</select>
	
</mapper>