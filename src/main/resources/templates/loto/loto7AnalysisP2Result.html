<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
  th:with="lang=${#locale.language}" th:lang="${lang}">
<head>
	<title>SHA LOTO</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body>

<!-- CSS -->
  <style type="text/css">
	html {
		-webkit-box-sizing: border-box;
		-moz-box-sizing: border-box;
		box-sizing: border-box;
	}
	*, *:before, *:after {
		-webkit-box-sizing: inherit;
		-moz-box-sizing: inherit;
		box-sizing: inherit;
	}
	
	.axis text {
		font: 10px sans-serif;
	}
	
	.axis path,
	.axis line {
		fill: none;
		stroke: #000;
		shape-rendering: crispEdges;
	}
	.x.axis path {
		display: none;
	}
	
	.bar {
		
	}

	.bar:hover {
		fill: orangered ;
	}


	.x.axis path {
		display: none;
	}
	
	.d3-tip {
		line-height: 1;
		font-weight: bold;
		padding: 12px;
		background: rgba(0, 0, 0, 0.8);
		color: #fff;
		border-radius: 2px;
	}

	/* Creates a small triangle extender for the tooltip */
	.d3-tip:after {
		box-sizing: border-box;
		display: inline;
		font-size: 10px;
		width: 100%;
		line-height: 1;
		color: rgba(0, 0, 0, 0.8);
		content: "\25BC";
		position: absolute;
		text-align: center;
	}

	/* Style northward tooltips differently */
	.d3-tip.n:after {
		margin: -1px 0 0 0;
		top: 100%;
		left: 0;
	}
	
	</style>

<div class="row">
	<div class="col-sm-12">
		<div class="bs-component">
			<ul class="nav nav-tabs">
				<li class="nav-item">
					<a id="nomalNumberChartClk" class="nav-link" data-toggle="tab" href="#nomalNumberChartDiv" 
						th:text="${T(sha.work.enums.Loto7NumberType).NOMAL_NUMBER.getName()}"></a>
				</li>
				<li class="nav-item">
					<a id="bonusNumber1ChartClk" class="nav-link" data-toggle="tab" href="#bonusNumber1ChartDiv" 
						th:text="${T(sha.work.enums.Loto7NumberType).BONUS_NUMBER1.getName()}"></a>
				</li>
				<li class="nav-item">
					<a id="bonusNumber2ChartClk" class="nav-link" data-toggle="tab" href="#bonusNumber2ChartDiv"
						th:text="${T(sha.work.enums.Loto7NumberType).BONUS_NUMBER2.getName()}"></a>
				</li>
			</ul>
			<div id="chartTabContent" class="tab-content">
				<!-- nomalNumberChart -->
				<div class="tab-pane fade" id="nomalNumberChartDiv">
					<div class="col-sm-12">
						<legend>グラフ</legend>
					</div>
					<div class="col-sm-12 div-center">
						<svg class="nomalNumChartSvg"></svg>
					</div>
					<div class="col-sm-12">
						<legend>データ</legend>
					</div>
					<div class="col-sm-12 table-responsive">
						<table class="table table-striped table-bordered table-hover">
							<thead>
								<tr>
									<td class="td-t2s label-14b text-center">数字</td>
									<td class="info label-14b text-center" th:text="${T(sha.work.enums.Loto7NumberType).NOMAL_NUMBER.getName()}"></td>
								</tr>
							</thead>
							<tbody>
								<tr th:each="member : ${resultList.p1List}">
									<td class="text-center label-14b" th:text="${member.numberName}"></td>
									<td class="text-right">
										<span class="badge badge-primary label-14b">
											<span style="color: #E7CF59" th:text="${member.numberValue}"></span>回
										</span>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<!-- bonusNumber1Chart -->
				<div class="tab-pane fade" id="bonusNumber1ChartDiv">
					<div class="col-sm-12">
						<legend>グラフ</legend>
					</div>
					<div class="col-sm-12">
						<svg class="bonusNumber1Chart"></svg>
					</div>
					<div class="col-sm-12">
						<legend>データ</legend>
					</div>
					<div class="col-sm-12 table-responsive">
						<table class="table table-striped table-bordered table-hover">
							<thead>
								<tr>
									<td class="td-t2s label-14b text-center">数字</td>
									<td class="danger label-14b text-center" th:text="${T(sha.work.enums.Loto7NumberType).BONUS_NUMBER1.getName()}"></td>
								</tr>
							</thead>
							<tbody>
								<tr th:each="member : ${resultList.p1List}">
									<td class="text-center label-14b" th:text="${member.numberName}"></td>
									<td class="text-right">
										<span class="badge badge-info label-14b">
											<span style="color: #E7CF59" th:text="${member.bonusNumber1Value}"></span>回
										</span>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<!-- bonusNumber2Chart -->
				<div class="tab-pane fade" id="bonusNumber2ChartDiv">
					<div class="col-sm-12">
						<legend>グラフ</legend>
					</div>
					<div class="col-sm-12">
						<svg class="bonusNumber2Chart"></svg>
					</div>
					<div class="col-sm-12">
						<legend>データ</legend>
					</div>
					<div class="col-sm-12 table-responsive">
						<table class="table table-striped table-bordered table-hover">
							<thead>
								<tr>
									<td class="td-t2s label-14b text-center">数字</td>
									<td class="warning label-14b text-center" th:text="${T(sha.work.enums.Loto7NumberType).BONUS_NUMBER2.getName()}"></td>
								</tr>
							</thead>
							<tbody>
								<tr th:each="member : ${resultList.p1List}">
									<td class="text-center label-14b" th:text="${member.numberName}"></td>
									<td class="text-right">
										<span class="badge badge-warning label-14b">
											<span style="color: #E7CF59" th:text="${member.bonusNumber2Value}"></span>回
										</span>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div id="testJson"></div>
</div>
<script type="text/javascript" th:inline="javascript">

/*<![CDATA[*/

	$(document).ready(function(){
		
		var svgWidth = $('#okPanel').width()-40;
	    var svgHeight = 300;
		var data = /*[[${resultList.p1List}]]*/ null;
		
		creataNomalNumberChart(svgWidth, svgHeight, data);
		creataBonusNumber1Chart(svgWidth, svgHeight, data);
		creataBonusNumber2Chart(svgWidth, svgHeight, data);
	    
		$('#okPanelTitle').text("ロト7(LOTO7)各数字過去出た回数");
		$("#nomalNumberChartClk").click();
	});	
	/**
	 * draw nomalNumber bar chart
	 */
	function creataNomalNumberChart(svgWidth, svgHeight, data) {
		
	    var margin = {top: 20, right: 30, bottom: 40, left: 30};
	    var width = svgWidth - margin.left - margin.right;
	    var height = svgHeight - margin.top - margin.bottom;

		var x = d3.scaleBand().rangeRound([0, width]).paddingInner(0.1);
	
		var y = d3.scaleLinear().range([height, 0]);
	
		var chart = d3.select(".nomalNumChartSvg")
					    .attr("width", width + margin.left + margin.right)
					    .attr("height", height + margin.top + margin.bottom)
					  	.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");
		
		//add title
				
		var title = /*[[${T(sha.work.enums.Loto7NumberType).NOMAL_NUMBER.getName()}]]*/ 
		title += "各数字過去出た回数";
		chart.append("text")
			.attr("x", (width / 2))
			.attr("y", (margin.top / 2))
			.attr("text-anchor", "middle")  
			.style("font-size", "16px") 
			.style("font-weight", "bold")
			.text(title);
		
		//bottom comment
		chart.append("text")
			.attr("x", width)
			.attr("y", height + margin.top + 10)
			.attr("text-anchor", "end")  
			.style("font-size", "12px") 
			.text("（X軸：数字；　Y軸：回数）");
	
		var chartTopMargin = 5;
		x.domain(data.map(function(d) { return d.numberName; }));
		y.domain([0, d3.max(data, function(d) { return d.numberValue; })+chartTopMargin]);
		
		var numberTip = d3.tip()
					.attr("class", "d3-tip")
					.offset([-10, 0])
					.html(function(d) {
						return "<strong>出た回数:</strong> <span style='color:red'>" + d.numberValue + "</span>";
					});
		
		chart.call(numberTip);
		
		var bar = chart.selectAll("g")
						.data(data)
						.enter().append("g")
						.attr("transform", function(d) { return "translate(" + x(d.numberName) + ",0)"; });
	
		bar.append("rect")
			.attr("y", function(d) { return y(d.numberValue); })
			.attr("height", function(d) { return height - y(d.numberValue); })
			.attr("width",x.bandwidth())
			.attr("class", "bar")
			.attr("fill", /*[[${T(sha.work.enums.Loto7NumberType).NOMAL_NUMBER.getBarColor()}]]*/)
			.on('mouseover', numberTip.show)
			.on('mouseout', numberTip.hide);
	
		bar.append("text")
			.attr("x", x.bandwidth() / 2)
			.attr("y", function(d) { return y(d.numberValue) + 3; })
			.attr("dy", ".71em")
			.text(function(d) { return ""; });
	
		var xAxis = d3.axisBottom().scale(x);
		var yAxis = d3.axisLeft().scale(y);
		  
		chart.append("g")
		    .attr("class", "axis")
		    .attr("transform", "translate(0," + height + ")")
		    .call(xAxis);
		
		chart.append("g")
			.attr("class", "axis")
			.call(yAxis)
			.append("text")
	    	.attr("transform", "rotate(90)")
		    .attr("x", height-10)
			.attr("y", y(y.ticks().pop()) + 25)
			.attr("dy", "0.32em")
		    .attr("fill", "#000")
			.attr("font-weight", "bold")
			.attr("text-anchor", "start")
		    //.text("回数")
		    ;
	}
	
	/**
	 * draw bonusNumber1 bar chart
	 */
	function creataBonusNumber1Chart(svgWidth, svgHeight, data) {
		
	    var margin = {top: 20, right: 30, bottom: 40, left: 30};
	    var width = svgWidth - margin.left - margin.right;
	    var height = svgHeight - margin.top - margin.bottom;

		var x = d3.scaleBand().rangeRound([0, width]).padding(0.1);
	
		var y = d3.scaleLinear().range([height, 0]);
	
		var chart = d3.select(".bonusNumber1Chart")
					    .attr("width", width + margin.left + margin.right)
					    .attr("height", height + margin.top + margin.bottom)
					  	.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");
	
		//add title
		
		var title = /*[[${T(sha.work.enums.Loto7NumberType).BONUS_NUMBER1.getName()}]]*/ 
		title += "各数字過去出た回数";
		chart.append("text")
			.attr("x", (width / 2))
			.attr("y", (margin.top / 2))
			.attr("text-anchor", "middle")  
			.style("font-size", "16px") 
			.style("font-weight", "bold")
			.text(title);
		
		//bottom comment
		chart.append("text")
			.attr("x", width)
			.attr("y", height + margin.top + 10)
			.attr("text-anchor", "end")  
			.style("font-size", "12px") 
			.text("（X軸：数字；　Y軸：回数）");
		
		var chartTopMargin = 5;
		x.domain(data.map(function(d) { return d.numberName; }));
		y.domain([0, d3.max(data, function(d) { return d.bonusNumber1Value; })+chartTopMargin]);
		
		var numberTip = d3.tip()
					.attr("class", "d3-tip")
					.offset([-10, 0])
					.html(function(d) {
						return "<strong>出た回数:</strong> <span style='color:red'>" + d.bonusNumber1Value + "</span>";
					});
		
		chart.call(numberTip);
		
		var bar = chart.selectAll("g")
						.data(data)
						.enter().append("g")
						.attr("transform", function(d) { return "translate(" + x(d.numberName) + ",0)"; });
	
		bar.append("rect")
			.attr("y", function(d) { return y(d.bonusNumber1Value); })
			.attr("height", function(d) { return height - y(d.bonusNumber1Value); })
			.attr("width",x.bandwidth())
			.attr("class", "bar")
			.attr("fill", /*[[${T(sha.work.enums.Loto7NumberType).BONUS_NUMBER1.getBarColor()}]]*/)
			.on('mouseover', numberTip.show)
			.on('mouseout', numberTip.hide);
	
		bar.append("text")
			.attr("x", x.bandwidth() / 2)
			.attr("y", function(d) { return y(d.bonusNumber1Value) + 3; })
			.attr("dy", ".71em")
			.text(function(d) { return ""; });
	
		var xAxis = d3.axisBottom().scale(x);
		var yAxis = d3.axisLeft().scale(y);
		  
		chart.append("g")
		    .attr("class", "axis")
		    .attr("transform", "translate(0," + height + ")")
		    .call(xAxis);
		
		var title = /*[[${T(sha.work.enums.Loto7NumberType).BONUS_NUMBER1.getName()}]]*/ 
			title += "各数字過去出た回数";
		chart.append("g")
			.attr("class", "axis")
			.call(yAxis)
			.append("text")
	    	//.attr("transform", "rotate(-90)")
		    .attr("x", 2)
			.attr("y", y(y.ticks().pop()) + 0.5)
			.attr("dy", "0.32em")
		    .attr("fill", "#000")
			.attr("font-weight", "bold")
			.attr("text-anchor", "start")
		    //.text(title)
		    ;
	}
	
	/**
	 * draw bonusNumber2 bar chart
	 */
	function creataBonusNumber2Chart(svgWidth, svgHeight, data) {
		
	    var margin = {top: 20, right: 30, bottom: 40, left: 30};
	    var width = svgWidth - margin.left - margin.right;
	    var height = svgHeight - margin.top - margin.bottom;

		var x = d3.scaleBand().rangeRound([0, width]).padding(0.1);
	
		var y = d3.scaleLinear().range([height, 0]);
	
		var chart = d3.select(".bonusNumber2Chart")
					    .attr("width", svgWidth)
					    .attr("height", svgHeight)
					  	.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");
	
		//add title
		var title = /*[[${T(sha.work.enums.Loto7NumberType).BONUS_NUMBER2.getName()}]]*/ 
		title += "各数字過去出た回数";
		chart.append("text")
			.attr("x", (width / 2))
			.attr("y", (margin.top / 2))
			.attr("text-anchor", "middle")  
			.style("font-size", "16px") 
			.style("font-weight", "bold")
			.text(title);
		
		//bottom comment
		chart.append("text")
			.attr("x", width)
			.attr("y", height + margin.top + 10)
			.attr("text-anchor", "end")  
			.style("font-size", "12px") 
			.text("（X軸：数字；　Y軸：回数）");
		
		var chartTopMargin = 5;
		x.domain(data.map(function(d) { return d.numberName; }));
		y.domain([0, d3.max(data, function(d) { return d.bonusNumber2Value; })+chartTopMargin]);
		
		var numberTip = d3.tip()
					.attr("class", "d3-tip")
					.offset([-10, 0])
					.html(function(d) {
						return "<strong>出た回数:</strong> <span style='color:red'>" + d.bonusNumber2Value + "</span>";
					});
		
		chart.call(numberTip);
		
		var bar = chart.selectAll("g")
						.data(data)
						.enter().append("g")
						.attr("transform", function(d) { return "translate(" + x(d.numberName) + ",0)"; });
	
		bar.append("rect")
			.attr("y", function(d) { return y(d.bonusNumber2Value); })
			.attr("height", function(d) { return height - y(d.bonusNumber2Value); })
			.attr("width",x.bandwidth())
			.attr("class", "bar")
			.attr("fill", /*[[${T(sha.work.enums.Loto7NumberType).BONUS_NUMBER2.getBarColor()}]]*/)
			.on('mouseover', numberTip.show)
			.on('mouseout', numberTip.hide);
	
		bar.append("text")
			.attr("x", x.bandwidth() / 2)
			.attr("y", function(d) { return y(d.bonusNumber2Value) + 3; })
			.attr("dy", ".71em")
			.text(function(d) { return ""; });
	
		var xAxis = d3.axisBottom().scale(x);
		var yAxis = d3.axisLeft().scale(y);
		  
		chart.append("g")
		    .attr("class", "axis")
		    .attr("transform", "translate(0," + height + ")")
		    .call(xAxis);
		
		var title = /*[[${T(sha.work.enums.Loto7NumberType).BONUS_NUMBER2.getName()}]]*/ 
			title += "各数字過去出た回数";
		chart.append("g")
			.attr("class", "axis")
			.call(yAxis)
			.append("text")
	    	//.attr("transform", "rotate(-90)")
		    .attr("x", 2)
			.attr("y", y(y.ticks().pop()) + 0.5)
			.attr("dy", "0.32em")
		    .attr("fill", "#000")
			.attr("font-weight", "bold")
			.attr("text-anchor", "start")
		    //.text(title)
		    ;
	}


/*]]>*/
</script>	
	
</body>

</html>