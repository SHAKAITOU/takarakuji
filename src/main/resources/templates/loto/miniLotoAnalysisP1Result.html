<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
  th:with="lang=${#locale.language}" th:lang="${lang}">
<head>
	<title>SHA LOTO</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body>

<!-- CSS -->
<style type="text/css">


</style>
<div class="row">
	<div class="col-md-12 col-sx-12">
		<div class="bs-component">
			<ul class="nav nav-tabs">
				<li class="nav-item">
					<a id="nomalNumberChartClk" class="nav-link" data-toggle="tab" href="#nomalNumberChartDiv" 
						th:text="${T(sha.work.enums.MiniLotoNumberType).NOMAL_NUMBER.getName()}"></a>
				</li>
				<li class="nav-item">
					<a id="bonusNumber1ChartClk" class="nav-link" data-toggle="tab" href="#bonusNumber1ChartDiv" 
						th:text="${T(sha.work.enums.MiniLotoNumberType).BONUS_NUMBER1.getName()}"></a>
				</li>
			</ul>
			<div id="chartTabContent" class="tab-content">
				<!-- nomalNumberChart -->
				<div class="tab-pane fade" id="nomalNumberChartDiv">
					<div class="col-md-12 col-sx-12">
						<div class="col-md-12 col-sx-12 div-center">
							<canvas id="nomalNumberChart"></canvas>
						</div>
					</div>
					<div class="col-md-12  col-sx-12">
						<legend>データ</legend>
					</div>
					<div class="col-md-12 col-sx-12 table-responsive">
						<table class="table table-striped table-bordered table-hover">
							<thead>
								<tr>
									<td class="td-t2s label-14b text-center">数字</td>
									<td class="td-t2s label-14b text-center">当選回数</td>
								</tr>
							</thead>
							<tbody>
								<tr th:each="member : ${resultList.p1List}">
									<td class="text-center label-14b" th:text="${member.numberName}"></td>
									<td class="text-right">
										<span class="badge badge-primary label-14b">
											<span style="color: #E7CF59" th:text="${member.numberValue}"></span>回
										</span>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<!-- bonusNumber1Chart -->
				<div class="tab-pane fade" id="bonusNumber1ChartDiv">
					<div class="col-md-12 col-sx-12">
						<div class="col-md-12 col-sx-12 div-center">
							<canvas id="bonusNumber1Chart"></canvas>
						</div>
					</div>
					<div class="col-md-12 col-sx-12">
						<legend>データ</legend>
					</div>
					<div class="col-md-12 col-sx-12 table-responsive">
						<table class="table table-striped table-bordered table-hover">
							<thead>
								<tr>
									<td class="td-t2s label-14b text-center">数字</td>
									<td class="td-t2s label-14b text-center">当選回数</td>
								</tr>
							</thead>
							<tbody>
								<tr th:each="member : ${resultList.p1List}">
									<td class="text-center label-14b" th:text="${member.numberName}"></td>
									<td class="text-right">
										<span class="badge badge-info label-14b">
											<span style="color: #E7CF59" th:text="${member.bonusNumber1Value}"></span>回
										</span>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript" th:inline="javascript">

/*<![CDATA[*/

	$(document).ready(function(){
		
		//active btn bond
		var loto6AnalysisP1ResultBtn = null;

		//--------------------------------------------------------[
		//title init
		var titleHeader = "ミニロト(MINILOTO)";
		var titleFooter = "各数字過去当選回数";
		var xTitle = "（X軸：数字；　Y軸：当選回数）";
		//--------------------------------------------------------]
		
		
		
		//--------------------------------------------------------[
		//data init
		var data = /*[[${resultList.p1List}]]*/ null;
		var bgColors = [];
		var bColors = [];
		var lbs = [];
		var nomalNumberDatas =[];
		var bonusNumber1Datas =[];
		for(n=0; n<data.length; n++) {
			bgColors.push(ShaColor.htmlColor.categorys[n].rgbA);
			bColors.push(ShaColor.htmlColor.categorys[n].rgbB);
			lbs.push(data[n].numberName);
			nomalNumberDatas.push(data[n].numberValue);
			bonusNumber1Datas.push(data[n].bonusNumber1Value);
		}
		//--------------------------------------------------------]
		
		//--------------------------------------------------------[
	    //page component init
	    
		$('#okPanelTitle').text(titleHeader + titleFooter);
		
	    var title = /*[[${T(sha.work.enums.MiniLotoNumberType).NOMAL_NUMBER.getName()}]]*/;
		title += titleFooter;		
		var ctx = $("#nomalNumberChart").get(0).getContext('2d');
		var avg = ShaCommon.util.getAverageInt(nomalNumberDatas);
	    var nomalNumberChart = drawBarChart(ctx, nomalNumberDatas, lbs, bgColors, bColors, title, xTitle, avg);
		
		var title = /*[[${T(sha.work.enums.MiniLotoNumberType).BONUS_NUMBER1.getName()}]]*/;
		title += titleFooter;			
		var ctx = $("#bonusNumber1Chart").get(0).getContext('2d');
		var avg = ShaCommon.util.getAverageInt(bonusNumber1Datas);
		var bonusNumber1Chart = drawBarChart(ctx, bonusNumber1Datas, lbs, bgColors, bColors, title, xTitle, avg);
		//--------------------------------------------------------]
		
		//--------------------------------------------------------[
		//init bond event to btn
		
		//nomalNumber Chart click event
		$btn_obj = $('#nomalNumberChartClk'); 
		$btn_obj.unbind();
		$btn_obj.on('click', function(event) {
			event.preventDefault();
			loto6AnalysisP1ResultBtn = $(this);
			
		});
		
		//bonusNumber1 Chart click event
		$btn_obj = $('#bonusNumber1ChartClk'); 
		$btn_obj.unbind();
		$btn_obj.on('click', function(event) {
			event.preventDefault();
			loto6AnalysisP1ResultBtn = $(this);

		});
		//--------------------------------------------------------]
		
		
		//--------------------------------------------------------[
		//init event
		$("#nomalNumberChartClk").click(); //default first click event
		
		//trigger when windows resize
		ShaCommon.util.triggerWinResize(
			function() {
				
			}
		);
		//--------------------------------------------------------]
		
	});	
	
	
	//init bond event to btn
	function initBondBtn() {
		
		
	}

	//draw bar chart
	function drawBarChart(ctx, datas, lbs, bgColors, bColors, 
							title, xTitle, avg) {
		var myChart = new Chart(ctx, {
		    type: 'bar',
		    data: {
		        labels: lbs,
		        datasets: [{
		            label: 'の当選回数',
		            data: datas,
		            backgroundColor: bgColors,
		            borderColor: bColors,
		            borderWidth: 1
		        }]
		    },
		    options: {
		    	legend: {
		    		display: false
		    	},
		    	title: {
					display: true,
					text: [title, xTitle]
				},
		        scales: {
		            yAxes: [{
		                ticks: {
		                    beginAtZero:true
		                }
		            }]
		        },
				annotation: {
		            annotations: [{
		                type: 'line',
		                mode: 'horizontal',
		                scaleID: 'y-axis-0',
		                value: avg,
		                borderColor: ShaColor.htmlColor.annotations[0].rgbB,
		                borderWidth: 1,
		                label: {
                            backgroundColor: ShaColor.htmlColor.annotations[0].rgbA,
                            borderColor: ShaColor.htmlColor.annotations[0].rgbB,
                            borderWidth: 1,
                            content: "平均回数:" + avg + "回",
                            enabled: true,
                            position: "left"
                        }
		            }]
		    	}
		    }
		});
		
		return myChart;
	}

/*]]>*/
</script>	
	
</body>

</html>